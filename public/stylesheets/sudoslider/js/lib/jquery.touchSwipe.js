/*
* touchSwipe - jQuery Plugin
* https://github.com/mattbryson/TouchSwipe-Jquery-Plugin
* http://labs.skinkers.com/touchSwipe/
* http://plugins.jquery.com/project/touchSwipe
*
* Copyright (c) 2010 Matt Bryson (www.skinkers.com)
* Dual licensed under the MIT or GPL Version 2 licenses.
*
* $version: 1.6.5
*/
(function(l){"function"===typeof define&&define.amd&&define.amd.jQuery?define(["jquery"],l):l(jQuery)})(function(l){function na(f){!f||void 0!==f.allowPageScroll||void 0===f.swipe&&void 0===f.swipeStatus||(f.allowPageScroll=Z);void 0!==f.click&&void 0===f.tap&&(f.tap=f.click);f||(f={});f=l.extend({},l.fn.swipe.defaults,f);return this.each(function(){var b=l(this),k=b.data(D);k||(k=new Da(this,f),b.data(D,k))})}function Da(f,b){function E(a){if(!0!==c.data(D+"_intouch")&&!(0<l(a.target).closest(b.excludedElements,
c).length)){var d=a.originalEvent?a.originalEvent:a,n,Ea=s?d.touches[0]:d;e=oa;s?g=d.touches.length:a.preventDefault();m=0;x=p=null;z=A=h=0;u=1;y=0;a=[];for(var f=0;5>=f;f++)a.push({start:{x:0,y:0},end:{x:0,y:0},identifier:0});q=a;a={};a[B]=Q(B);a[F]=Q(F);a[G]=Q(G);a[H]=Q(H);R=a;S=M=0;if(!s||g===b.fingers||b.fingers===N||O()){if($(0,Ea),T=C(),2==g&&($(1,d.touches[1]),A=z=aa(q[0].start,q[1].start)),b.swipeStatus||b.pinchStatus)n=v(d,e)}else n=!1;if(!1===n)return e=r,v(d,e),n;U(!0);return null}}function ba(a){var d,
n,c,f=a.originalEvent?a.originalEvent:a;if(e!==k&&e!==r&&!pa()){var E,w=qa(s?f.touches[0]:f);P=C();s&&(g=f.touches.length);e=I;2==g&&(0==A?($(1,f.touches[1]),A=z=aa(q[0].start,q[1].start)):(qa(f.touches[1]),z=aa(q[0].end,q[1].end),x=1>u?ca:da),u=(z/A*1).toFixed(2),y=Math.abs(A-z));if(g===b.fingers||b.fingers===N||!s||O()){d=w.start;n=w.end;d=Math.atan2(n.y-d.y,d.x-n.x);d=Math.round(180*d/Math.PI);0>d&&(d=360-Math.abs(d));d=p=45>=d&&0<=d?B:360>=d&&315<=d?B:135<=d&&225>=d?F:45<d&&135>d?H:G;if(b.allowPageScroll===
Z||O())a.preventDefault();else switch(n=b.allowPageScroll===ra,d){case B:(b.swipeLeft&&n||!n&&b.allowPageScroll!=ea)&&a.preventDefault();break;case F:(b.swipeRight&&n||!n&&b.allowPageScroll!=ea)&&a.preventDefault();break;case G:(b.swipeUp&&n||!n&&b.allowPageScroll!=fa)&&a.preventDefault();break;case H:(b.swipeDown&&n||!n&&b.allowPageScroll!=fa)&&a.preventDefault()}m=Math.round(Math.sqrt(Math.pow(w.end.x-w.start.x,2)+Math.pow(w.end.y-w.start.y,2)));h=P-T;a=p;d=m;d=Math.max(d,sa(a));R[a].distance=d;
if(b.swipeStatus||b.pinchStatus)E=v(f,e);if(!b.triggerOnTouchEnd||b.triggerOnTouchLeave){a=!0;if(b.triggerOnTouchLeave){c=l(this);var t=c.offset();a=t.left;d=t.left+c.outerWidth();n=t.top;c=t.top+c.outerHeight();a=w.end.x>a&&w.end.x<d&&w.end.y>n&&w.end.y<c}!b.triggerOnTouchEnd&&a?e=ga(I):b.triggerOnTouchLeave&&!a&&(e=ga(k));e!=r&&e!=k||v(f,e)}}else e=r,v(f,e);!1===E&&(e=r,v(f,e))}}function ha(a){var d=a.originalEvent;if(s&&0<d.touches.length)return M=C(),S=event.touches.length+1,!0;pa()&&(g=S);a.preventDefault();
P=C();h=P-T;ia()?(e=r,v(d,e)):b.triggerOnTouchEnd||!1==b.triggerOnTouchEnd&&e===I?(e=k,v(d,e)):!b.triggerOnTouchEnd&&b.tap?(e=k,J(d,e,ja)):e===I&&(e=r,v(d,e));U(!1);return null}function K(){z=A=T=P=g=0;u=1;S=M=0;U(!1)}function ka(a){a=a.originalEvent;b.triggerOnTouchLeave&&(e=ga(k),v(a,e))}function ta(){c.unbind(V,E);c.unbind(W,K);c.unbind(la,ba);c.unbind(ma,ha);L&&c.unbind(L,ka);U(!1)}function ga(a){var d=a,c=b.maxTimeThreshold?h>=b.maxTimeThreshold?!1:!0:!0,f=ua(),e=ia();!c||e?d=r:!f||a!=I||b.triggerOnTouchEnd&&
!b.triggerOnTouchLeave?!f&&a==k&&b.triggerOnTouchLeave&&(d=r):d=k;return d}function v(a,d){var c=void 0;va()&&wa()||wa()?c=J(a,d,xa):(ya()&&O()||O())&&!1!==c&&(c=J(a,d,za));Aa()&&b.doubleTap&&!1!==c?c=J(a,d,Ba):h>b.longTapThreshold&&m<Fa&&b.longTap&&!1!==c?c=J(a,d,Ca):!(1!==g&&s||!isNaN(m)&&0!==m)&&b.tap&&!1!==c&&(c=J(a,d,ja));d===r&&K(a);d===k&&(s?0==a.touches.length&&K(a):K(a));return c}function J(a,d,f){var e=void 0;if(f==xa){c.trigger("swipeStatus",[d,p||null,m||0,h||0,g]);if(b.swipeStatus&&(e=
b.swipeStatus.call(c,a,d,p||null,m||0,h||0,g),!1===e))return!1;if(d==k&&va()){c.trigger("swipe",[p,m,h,g]);if(b.swipe&&(e=b.swipe.call(c,a,p,m,h,g),!1===e))return!1;switch(p){case B:c.trigger("swipeLeft",[p,m,h,g]);b.swipeLeft&&(e=b.swipeLeft.call(c,a,p,m,h,g));break;case F:c.trigger("swipeRight",[p,m,h,g]);b.swipeRight&&(e=b.swipeRight.call(c,a,p,m,h,g));break;case G:c.trigger("swipeUp",[p,m,h,g]);b.swipeUp&&(e=b.swipeUp.call(c,a,p,m,h,g));break;case H:c.trigger("swipeDown",[p,m,h,g]),b.swipeDown&&
(e=b.swipeDown.call(c,a,p,m,h,g))}}}if(f==za){c.trigger("pinchStatus",[d,x||null,y||0,h||0,g,u]);if(b.pinchStatus&&(e=b.pinchStatus.call(c,a,d,x||null,y||0,h||0,g,u),!1===e))return!1;if(d==k&&ya())switch(x){case da:c.trigger("pinchIn",[x||null,y||0,h||0,g,u]);b.pinchIn&&(e=b.pinchIn.call(c,a,x||null,y||0,h||0,g,u));break;case ca:c.trigger("pinchOut",[x||null,y||0,h||0,g,u]),b.pinchOut&&(e=b.pinchOut.call(c,a,x||null,y||0,h||0,g,u))}}if(f==ja){if(d===r||d===k)clearTimeout(X),b.doubleTap&&!Aa()?(t=
C(),X=setTimeout(l.proxy(function(){t=null;c.trigger("tap",[a.target]);b.tap&&(e=b.tap.call(c,a,a.target))},this),b.doubleTapThreshold)):(t=null,c.trigger("tap",[a.target]),b.tap&&(e=b.tap.call(c,a,a.target)))}else if(f==Ba){if(d===r||d===k)clearTimeout(X),t=null,c.trigger("doubletap",[a.target]),b.doubleTap&&(e=b.doubleTap.call(c,a,a.target))}else f!=Ca||d!==r&&d!==k||(clearTimeout(X),t=null,c.trigger("longtap",[a.target]),b.longTap&&(e=b.longTap.call(c,a,a.target)));return e}function ua(){var a=
!0;null!==b.threshold&&(a=m>=b.threshold);return a}function ia(){var a=!1;null!==b.cancelThreshold&&null!==p&&(a=sa(p)-m>=b.cancelThreshold);return a}function ya(){var a=g===b.fingers||b.fingers===N||!s,d=0!==q[0].end.x,c;c=null!==b.pinchThreshold?y>=b.pinchThreshold:!0;return a&&d&&c}function O(){return!!(b.pinchStatus||b.pinchIn||b.pinchOut)}function va(){var a=b.maxTimeThreshold?h>=b.maxTimeThreshold?!1:!0:!0,d=ua(),c=g===b.fingers||b.fingers===N||!s,e=0!==q[0].end.x;return!ia()&&e&&c&&d&&a}function wa(){return!!(b.swipe||
b.swipeStatus||b.swipeLeft||b.swipeRight||b.swipeUp||b.swipeDown)}function Aa(){if(null==t)return!1;var a=C();return!!b.doubleTap&&a-t<=b.doubleTapThreshold}function pa(){var a=!1;M&&C()-M<=b.fingerReleaseThreshold&&(a=!0);return a}function U(a){!0===a?(c.bind(la,ba),c.bind(ma,ha),L&&c.bind(L,ka)):(c.unbind(la,ba,!1),c.unbind(ma,ha,!1),L&&c.unbind(L,ka,!1));c.data(D+"_intouch",!0===a)}function $(a,b){q[a].identifier=void 0!==b.identifier?b.identifier:0;q[a].start.x=q[a].end.x=b.pageX||b.clientX;q[a].start.y=
q[a].end.y=b.pageY||b.clientY;return q[a]}function qa(a){var b=void 0!==a.identifier?a.identifier:0;a:{for(var c=0;c<q.length;c++)if(q[c].identifier==b){b=q[c];break a}b=void 0}b.end.x=a.pageX||a.clientX;b.end.y=a.pageY||a.clientY;return b}function sa(a){if(R[a])return R[a].distance}function Q(a){return{direction:a,distance:0}}function aa(a,b){var c=Math.abs(a.x-b.x),e=Math.abs(a.y-b.y);return Math.round(Math.sqrt(c*c+e*e))}function C(){return(new Date).getTime()}var Y=s||!b.fallbackToMouseEvents,
V=Y?"touchstart":"mousedown",la=Y?"touchmove":"mousemove",ma=Y?"touchend":"mouseup",L=Y?null:"mouseleave",W="touchcancel",m=0,p=null,h=0,A=0,z=0,u=1,y=0,x=0,R=null,c=l(f),e="start",g=0,q=null,T=0,P=0,M=0,S=0,t=0,X=null;try{c.bind(V,E),c.bind(W,K)}catch(na){l.error("events not supported "+V+","+W+" on jQuery.swipe")}this.enable=function(){c.bind(V,E);c.bind(W,K);return c};this.disable=function(){ta();return c};this.destroy=function(){ta();c.data(D,null);return c};this.option=function(a,c){if(void 0!==
b[a]){if(void 0===c)return b[a];b[a]=c}else l.error("Option "+a+" does not exist on jQuery.swipe.options");return null}}var B="left",F="right",G="up",H="down",da="in",ca="out",Z="none",ra="auto",xa="swipe",za="pinch",ja="tap",Ba="doubletap",Ca="longtap",ea="horizontal",fa="vertical",N="all",Fa=10,oa="start",I="move",k="end",r="cancel",s="ontouchstart"in window,D="TouchSwipe";l.fn.swipe=function(f){var b=l(this),k=b.data(D);if(k&&"string"===typeof f){if(k[f])return k[f].apply(this,Array.prototype.slice.call(arguments,
1));l.error("Method "+f+" does not exist on jQuery.swipe")}else if(!(k||"object"!==typeof f&&f))return na.apply(this,arguments);return b};l.fn.swipe.defaults={fingers:1,threshold:75,cancelThreshold:null,pinchThreshold:20,maxTimeThreshold:null,fingerReleaseThreshold:250,longTapThreshold:500,doubleTapThreshold:200,swipe:null,swipeLeft:null,swipeRight:null,swipeUp:null,swipeDown:null,swipeStatus:null,pinchIn:null,pinchOut:null,pinchStatus:null,click:null,tap:null,doubleTap:null,longTap:null,triggerOnTouchEnd:!0,
triggerOnTouchLeave:!1,allowPageScroll:"auto",fallbackToMouseEvents:!0,excludedElements:"label, button, input, select, textarea, a, .noSwipe"};l.fn.swipe.phases={PHASE_START:oa,PHASE_MOVE:I,PHASE_END:k,PHASE_CANCEL:r};l.fn.swipe.directions={LEFT:B,RIGHT:F,UP:G,DOWN:H,IN:da,OUT:ca};l.fn.swipe.pageScroll={NONE:Z,HORIZONTAL:ea,VERTICAL:fa,AUTO:ra};l.fn.swipe.fingers={ONE:1,TWO:2,THREE:3,ALL:N}});